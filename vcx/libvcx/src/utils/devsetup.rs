extern crate rusqlite;
extern crate rand;

use utils::constants;
use utils::libindy::signus::SignusUtils;
use schema::{create_new_schema, get_sequence_num};
use credential_def::create_new_credentialdef;
use utils::libindy::wallet;
use utils::libindy::pool;
use settings;

/* INSTITUTION/ENTERPRISE settings */
pub const AGENCY_ENDPOINT: &'static str = "https://enym-eagency.pdev.evernym.com";
pub const AGENCY_DID: &'static str = "YRuVCckY6vfZfX9kcQZe3u";
pub const AGENCY_VERKEY: &'static str = "J8Yct6FwmarXjrE2khZesUXRVVSVczSoa9sFaGe6AD2v";
pub const SDK_TO_REMOTE_DID: &'static str = "AQ2EZRY9JQ4ssjmZPL5MiU";
pub const SDK_TO_REMOTE_VERKEY: &'static str = "684CRDu3k4TGBzNU99JTqM8cVS4ZtRwC7eZHEvZjzMRX";
pub const REMOTE_TO_SDK_DID: &'static str = "7csYfSY8b4hvqnu5K8nGQP";
pub const REMOTE_TO_SDK_VERKEY: &'static str = "4cDwBvDZy9aWWKf2uCYTSgffCNt7ffmY9nrMTHmqsG8z";
pub const INSTITUTION_DID: &'static str = "2hoqvcwupRTUNkXn6ArYzs";
pub const INSTITUTION_VERKEY: &'static str = "vrWGArMA3toVoZrYGSAMjR2i9KjBS66bZWyWuYJJYPf";

/**
 * CONSUMER/USER settings
 * generated by running provision script with: --enterprise-seed=00000000000000000000001DIRECTION --agent-seed=00000000000000000000002DIRECTION
 */

pub const C_AGENCY_ENDPOINT: &'static str = "https://cagency.pdev.evernym.com";
pub const C_AGENCY_DID: &'static str = "dTLdJqRZLwMuWSogcKfBT";
pub const C_AGENCY_VERKEY: &'static str = "LsPQTDHi294TexkFmZK9Q9vW4YGtQRuLV8wuyZi94yH";
pub const C_SDK_TO_REMOTE_DID: &'static str = "QgUb4aHJ2cigGZCrEe7DHk";
pub const C_SDK_TO_REMOTE_VERKEY: &'static str = "DubGpQctfhNRw4cmzqaHjne6qokwpxuWrhiTJgJEGs7q";
pub const C_REMOTE_TO_SDK_DID: &'static str = "7faARCpBNrEESKmvBejhV7";
pub const C_REMOTE_TO_SDK_VERKEY: &'static str = "4dhJ9JkxJm4n5QbYUR9r3KcUoC34yZJgXouRa2PKgMUE";
pub const C_INSTITUTION_DID: &'static str = "GXTZy9GzdtD2c1J88Jrn8C";
pub const C_INSTITUTION_VERKEY: &'static str = "9TnFnc8LQ8LhRQjLVjdBR7Sk63yjEkJ3ifvue4bftJJc";


static DEV_ENTRIES: &[[&str; 3]; 23] = &[
    //Todo: Remove all cred_defs that don't have updated format
    //Master secret for Creds: 9a440066-986c-42f8-8117-92178a0ee8a1 and credential::52b1f5e1-89eb-44fe-a846-b4131c0feadc
    [
        r#"master_secret::default_creds_in_wallet"#,
        r#"{"ms":"47614406654915460076643753636498934664671213203624341775626723533978097829041"}"#,
        r#"2018-04-24 18:50:43"#,
    ],
    //Credential for (name, age, sex, height)
    [
        r#"credential::52b1f5e1-89eb-44fe-a846-b4131c0feadc"#,
        r#"{"schema_id":"2hoqvcwupRTUNkXn6ArYzs:2:schema_name:0.0.11","cred_def_id":"2hoqvcwupRTUNkXn6ArYzs:3:CL:1766","rev_reg_id":null,"values":{"height":{"raw":"4'11","encoded":"25730877424947290072821310314181366395232879096832067784637233452620527354832"},"sex":{"raw":"male","encoded":"5944657099558967239210949258394887428692050081607692519917050011144233115103"},"name":{"raw":"Bob","encoded":"93006290325627508022776103386395994712401809437930957652111221015872244345185"},"age":{"raw":"111","encoded":"111"}},"signature":{"p_credential":{"m_2":"31700338570294708736115754102769589522052428093121126330650183539696104868123","a":"49601676634075338900070028928524149726487925281793674828957124876648267663653268441925518741079522588902026458004689292283218765775253940547711692488940734484770584293121765619789637205595565528030197398251772739160711829414291683630694542357941383648472710578891064506814853865352776842356131167581792624594024780254374488576235592054508415310652060407815394786143862011287725455672535235778156493796658817317873282151458406360581615076568830964642185034131454866772623531346179578574512288179869762913814220817883811492316426919329477002856130806067128988980897402861692342054721967293155173045244747092587727814420","e":"259344723055062059907025491480697571938277889515152306249728583105665800713306759149981690559193987143012367913206299323899696942213235956742930016827089645465924819329194664132427","v":"7368944502388947780877758834506011702570183901216689815925379005786185824370195318165100747967575969003319841575223043545043695686345374657934095689517642738913421712702634742423046316389106349284036179287654741629936916543420233130420083583441633480875003015843460256173151835333113143012996535675952455517391409157261905730091121182721233129020321736639139606159032251366470119121898161788294866508787629788335533867337601050334746907388384302673874581479560383933878267947908001203721612426681809671447575720088992433845241846395726393280306523913994131089954688884993208425074311910732405213197538862351190190756703478391541553412333085100884591925274157025314472402577392549697682729025714916634617384634636438917340761273154047312536194341393366982987985221224542488272691657022610656010807139506595471442974704443"},"r_credential":null},"signature_correctness_proof":{"se":"18377819366913492776795269414686931546644173819232792215393822234739083649077347846257465291121557932002679843971398964325947319856992017469536435142305623484966982727561298709321863886977889713310395780453482057443949762130910619567811625840516844224074682664688878745622323004621212800848688130468352709445748478989808312913918562918549242817920266170855087978165618352119368206423580394548348348627819187507747518380512231963467060234479175059767017756702176225640896064212682867174044952673579103361442534525991416968560081876539728363723256909118436431226516939233895765731279572519346250093055439831258410705256","c":"108684651170126349030378726557731186563004630763701952814764548750713164164480"},"rev_reg":null,"witness":null}"#,
        r#"2018-04-24 19:28:07"#,
    ],
    //Credential for (address1, address2, city, state, zip)
    [
        r#"credential::9a440066-986c-42f8-8117-92178a0ee8a1"#,
        r#"{"schema_id":"2hoqvcwupRTUNkXn6ArYzs:2:Home Address - Test:0.0.1","cred_def_id":"2hoqvcwupRTUNkXn6ArYzs:3:CL:2200","rev_reg_id":null,"values":{"address2":{"raw":"101 Wilson Lane","encoded":"68086943237164982734333428280784300550565381723532936263016368251445461241953"},"zip":{"raw":"87121","encoded":"87121"},"state":{"raw":"UT","encoded":"93856629670657830351991220989031130499313559332549427637940645777813964461231"},"city":{"raw":"SLC","encoded":"101327353979588246869873249766058188995681113722618593621043638294296500696424"},"address1":{"raw":"101 Tela Lane","encoded":"63690509275174663089934667471948380740244018358024875547775652380902762701972"}},"signature":{"p_credential":{"m_2":"31700338570294708736115754102769589522052428093121126330650183539696104868123","a":"4636119591016812829290185041314064883675977941392954691835215572067999994098323998287355564063288642448057198914007955141049641553998558342655341817968147923681804839333199224553010720316518489774808129770384979728163770781989361982362867405864793191346212322668423871529915985531698939342464472895631546091648999074714329706048885943777714077961459226335884116117378159655001226651964283566072892631751640720591491247756738698407744555551753963108283649698879786534551101148976909194325048048013605796054155971253949496310160721914633273138580991140248773945729425382987577485365556610172767253647545223951021726217","e":"259344723055062059907025491480697571938277889515152306249728583105665800713306759149981690559193987143012367913206299323899696942213235956742930255069409344197327246347865825149369","v":"5442392197275490888678809487702542129411897330335165518349275082394063964444764459344976892451887855371603165577568090327919173883059714296862721727215358869616013170379140986326303293564317963193155875114392812218277209407301424853735470891253146266115220918971185172915597652817147699337266471939333863190850407141319440480206198727571771575096356918545327625642715038205943409218674445922703749043356568580220877437155433918126574892935240102991561269648783872491907898462124176860659130579749282890223194188886254686328193788510579077319607954076688757747388284117610626744695237160950509347241199159392817197212143556383920998964158042067834305029632704153673110173377096213149084715712292184081094942159527450689357050524405595136635859200065054329700221161376446458745677994071419731935585227500023261202489309988"},"r_credential":null},"signature_correctness_proof":{"se":"8016730965404851883671241244847742779897307518356938915461303310917958391781042203321949584884293411578195441346244310457503548981917702566207857006166532786621695731732572457973866565424003312839043290389096991017444920115829021559534784061534056328585032371907532245699825735789291770981445297764543024517565822205895405808716728744858736584662975614326288901012532704599773904731383285993134427754432909321314476624239694781522251998092762597857704178774180446097807521183698610764223586215851551541519785420920809108710540394126512090304315606118633258027865078525787805526912281981545608511002815713525388149891","c":"47570451960219896208978703924196482810577196570400972965454633153633944823783"},"rev_reg":null,"witness":null}"#,
        r#"2018-04-24 18:57:57"#,
    ],
    //Cred Def (name, age, sex, height)
    [
        r#"credential_definition::2hoqvcwupRTUNkXn6ArYzs:3:CL:1766"#,
        r#"{"ver":"1.0","id":"2hoqvcwupRTUNkXn6ArYzs:3:CL:1766","schemaId":"1766","type":"CL","tag":"tag_1","value":{"primary":{"n":"85670726087646066488336891386007395146305556020785156404966757195713172423986955829275928823412202983005765549138166337596332668624785356275948550610986515632538875110102050429019717504369266063638809652430822315438476137278121638815507179841204863531316774758999960126711889562112923837514443800514317850283729280669445713214512397849522852970250520293370628023987786705929473911332225339413513152159168735396418164891236803242880355529495511789926285886513711866888153594898997566248543528468311456283695047260619287918479341245429034220764647748023750379734414646287862293454795971898087728286784691920341838448137","s":"48895504024055719252282124618440232058031534848578206135619251949712121688349796673339582444526655952256150398883881904202664306756997119627142187434717046388168662462146844076408165774647180386889611380385206737420317505498283253791892302072045630142000088540673466971882187409804378946284051501750733152717016201472399077914429936717916077927804505295461957441501910114156041614644522082760602249253154580010217682011334844149015826117564300568719161008968336214132279816077151249203387682493650606783046769332337727646199564020036298735732045166838761808856151309786819668360706306503342310612842842062124990515546","rms":"55124238634198767896989190912124101801487011776550531049312447160008911915805858769203263214247391370128743503884750230894992254782534916308717726458864563628155979232903142401564296059864163993116031948911890205924327079681120806660699807472835450774884790086176364904829785801662277817643758929102665315811587053743443282945894114636938504801919057589706112243215182511501766391979818825291302920046183286660535979356067095059954835317286058731752097960834846597182298966990903096087503981356191560896022130918467713965170833073908476890040573633790507632479986867071213812818198795980743816619101188007440501420265","r":{"age":"79929972605764081923928169118109955937942596882038299609840432190450415157811414028241147734830796420864094155361194743493925473416381796864930611869347074266004915138968792384389845406841032932617719658958723436255082233865110377263741339609575613130365442308529531653910993817930343800065420103045380167088004170924054961037495215662518438865451963740401001283847185440825394520018755223445249822872186182845486469782047535826324765776595892468234832738275924057319494419924315628980630597998542045737997098745582930334130943856199983122683939253199677301975621648701332042693361932882058162761100616061426948348543","height":"43697654968550374797747350883307769567970107595424042848512805574659637490865223884741325220130310747401007524946961961047017845562355761877737426362173154583282318280916311623979478993637611920564627949258044084829387202664209592421968240469632555878492380839645647416942442137379046765198550490385273422331119919271550814358484905381475425919535178852951065764007839694862254089647294876933345977086717739906732049870169676494191089473481599081434093267678201897983959623427881632398981639133464999426686464855321081382181128345439646915285092638523056862612805951888745466468189250809324704764539941950199029121971","name":"27840566146221839094706715525346987738366515228135228017756831827072413169413046928694128965437408314119378107001248938784196721251527841073562061895194786118493253747136558581733075085838344732480789080916888662025859959411548242570533062010040515389432781495404344078319329362199606647755846054419196223861030019941622364423035731925193585767512559046965068800397626154240642187951468078469705108550096993645093767062853160029488519782473627003415507531882531954861438232231891721714417260941929814209174229666951402683368064286591984536839119460188912988900108628619550933316716732412362877261351972856300122725311","sex":"71158203193750814064645375984366289525023807285706974372053265087711762931967467457554424128570575799858299309138634525043581231453147467503639632480265606639514062588328430127779672922238978691997220142175467697734098017929945137388449540960291382353668274221326494232576453309184313723101468125996133583526118906042917884532786929639595465607719907949555179768645947946981446856348818792433233118639837742069342704294935667439277239300646544113048542552827641463282313161399477040781496613299883600376036871188455649194997160235641221885445254669885796118738018184793667058106666699310811507432030227134716212047333"},"rctxt":"46606974474612014334162813245959294798707146182345915725873320666416778586578709957582488065967215123844938147674294546045791142893529089026398918551206210643866813978533328370848453659996387385511962923603572107178623194018405428385190973505221119367320335540594532470787856455921337677668578139252475145354234311100004305690589456708027099064648417473658511653099151260531601662756845340171017245856745300084817459702221188800561693628267844595681982119133481934447591267321276462929855060721008153063898005475842096089126631737443304095112651960840345194478557131329368107262793271894132562017615592189048496339519","z":"60222862808154508281297023025259735001427343046551141959163454367838016848706795315248494477792881583013815346697369970553138110643231336620915400570174832562872183404972955224273797034336370218410043817991576265727516252943173790666762397154310941587925498280737589255324684234151269065685202719709047222912280174448619733169146108763804041628255034238795689634672673743584092325797165484935092319400849217787411837911919848315181813915271474347326056160289723217712312631600631662631140752133660467530823692485682501264500394540081047269717924751711699504457332780721631237562317459266291656316385680277090654170043"}}}"#,
        r#"2018-04-18 14:05:01"#
    ],
    [
        r#"credential_private_key::2hoqvcwupRTUNkXn6ArYzs:3:CL:1766"#,
        r#"{"p_key":{"p":"142632561446479716106721356962210173594556553945608795218866788080611092676164575157569767691174300956550089354923401593878893285691130030676105299831196077713993088377832108439437885363548197669957339135510693869061850448450894392167718531059425235973916112569110509107630777707534068592490648336897013781161","q":"150159832402281532899635064466370954472681002035520473700839188683878625830424353285731439360924923530608176746276650900072307372004785602329993411380485731883825391076229250594391298096030418274020295570775767899970170993903736953844146865756741220722343925910725840497550427849761031287948776518403160834009"},"r_key":null}"#,
        r#"2018-04-18 14:05:01"#
    ],
    [
        r#"credential_key_correctness_proof::2hoqvcwupRTUNkXn6ArYzs:3:CL:1766"#,
        r#"{"c":"81455034389059130581506970475392033040313255495112570189348030990050944959723","xz_cap":"313645697267968767252234073635675430449902008059550004460259716107399731378591839990019486954341409015811398444145390509019258403747288031702507727573872041899321045924287139508392740014051146807378366748171039375722083582850094590251566094137198468729226768809401256609008814847622114541957109991869490323195581928533376835343922482073783968747913611549869005687592623346914265913612170394649557294382253996246104002213172081216651539025706643350612557508228429410997102814965307308636524874409734625285377555470610010065029649043789306111101285927931757335536116856245613021564584847709796772325323716389295248332887528840195072737364278387101996545501723112970168561425282691953586374723401","xr_cap":{"age":"882754630824080045376337358848444600715931719237593270810742883245639461185815851876695993155364347227577960272007297643455666310248109151421699898719086697252758726897984721300131927517824869533193272729923436764134176057310403382007926964744387461941410106739551156849252510593074993038770740497381973934250838808938096281745915721201706218145129356389886319652075267352853728443472451999347485331725183791798330085570375973775830893185375873153450320600510970851511952771344003741169784422212142610068911032856394030732377780807267819554991221318614567131747542069695452212861957610989952712388162117309870024706736915145245688230386906705817571265829695877232812698581971245658766976413035","height":"987637616420540109240639213457114631238834322455397854134075974962516028070241761486895351636137675737583463907200584608953198912009428606796987435233170230262246507002244616435810064614719873830573727071246389627645604379157359983051337498205555868770767724876429776832782322071025598605854225056296405802351270140259313942108556513054492873024197036931111152136704979025907027537437514085689067466225661223523070057146052814725207863140129032189711026590245299845102901392525049014890473357388530510591717159458757929233202259332009161834669583439224425159885860519286698297401104830776447810193871233628235105641793685350321428066559473844839135685992587694149460959649026855973744322255314","name":"1546639434545851623074023662485597065284112939224695559955181790271051962463722945049040324831863838273446566781589598791986646525127962031342679728936610678403807319789934638790962870799709103831307094501191346766422178361730723105585107221227683700136793784629414737866344469139276697568820727798174438114746109084012381033673759358527018948810066386903378176283974585934466197449653414224049202874335628877153172622300824161652402616917051692229112366954543190460604470158025596786552965425465904108943932508335616457348969058666355825158659883154681844070175331759147881082936624886840666700175491257446990494466033687900546604556189308597860524376648979247121908124398665458633017197827236","sex":"716474787042335984121980741678479956610893721743783933016481046646620232719875607171626872246169633453851120125820240948330986140162546620706675695953306343625792456607323180362022779776451183315417053730047607706403536921566872327898942782065882640264019040337889347226013768331343768976174940163847488834059250858062959921604207705933170308295671034308248661208253191415678118624962846251281290296191433330052514696549137940098226268222146864337521249047457556625050919427268119508782974114298993324181252788789806496387982332099887944556949042187369539832351477275159404450154234059063271817130338030393531532967222197942953924825232879558249711884940237537025210406407183892784259089230597"}}"#,
        r#"2018-04-18 14:05:01"#
    ],
    [
        r#"full_schema_id::2hoqvcwupRTUNkXn6ArYzs:3:CL:1766"#,
        r#"2hoqvcwupRTUNkXn6ArYzs:2:schema_name:0.0.11"#,
        r#"2018-04-18 14:05:01"#
    ],
    //Cred Def (address1, address2, city, state zip)
    [
        r#"credential_definition::2hoqvcwupRTUNkXn6ArYzs:3:CL:2200"#,
        r#"{"ver":"1.0","id":"2hoqvcwupRTUNkXn6ArYzs:3:CL:2200","schemaId":"2200","type":"CL","tag":"tag_1","value":{"primary":{"n":"88741284735403627216579666445694560558291418910640885296627342810813627933761476222534542086276727126630226733088063195376716384706469172092923179837908728253289279633399513435651713873851291740703722216980636849177504347147685486967494304077144889107783736436339681101052231156979418107515805123711768725575028387421426023825216921186491086591770148727981419917910961690179017275154157394430305159246222234015246854150924781029677935632380150766468104112585143944752056528191020319252022377887959963099791448503890283755396791644156566260224646337216549248538436113605405990054347447087414661022163623782149242755281","s":"23422138450373260989546372803115905641429253019932757265764411814693917814730423396029543506427431107665463947114169534076042193815528183146645420258112474862719021707331593605396225768279207734279633815192422338334694078772537553126536044898975802734897891868806614190697417567363338252065297043091389320715898373041509995550073447371429038334554743966249912729606382433360147646177567244229035730937621795612488768368095424517559734254618036657745253362566956753330419475460542872607366002966225352713533684180880587812941450913626746889267368030392100454734606127330235116180237948466508587790217696662741065259267","rms":"14447975426311280479267132899990817489642669520214924034998252453489878720129716543819898252550917326007580824656081988032523858513123563167777630315137695361795797869632927119293523112768579245237362505316312236387692966651790066151195595298934567834474278895809726258324375630086066640958723484758807579558930597918236747606697358633527807930259505684259342001021950836180573604506227244690564184163809645915604366081096410734484575261506736276140979835103702656776033509038812552269730221450265820294148773417211917674516951997126843255319065938921384137073696700116755175666936459116936561934469841477892805256141","r":{"address1":"2329876614391411563216683676077262228807847984352010100994890569466145378804569973486952228457580070495645577096128323607220991946128378534929692246880254438512269402045990696920755520338869296240866474579730425540671161142974502897590569823444794818539268860195366564053797409235605669968962252967383128091733606890808872142019223473959683244898299588101611186189505053459440511260001236088455626342091340089542616819011542772831670501003374326119607136962331648177694614060843189523323211413325653051905878406602013492391525669304577640049743766383004621970399078582660516043951364551586458397689565264219982128251","address2":"19555477601739386095981730245686558150891541525006779166172451283338091012567527259543439693497829546050281467156813553623726310059614444378581120194452489782393859492815326995392721685596909502791668405483605897205502023919264433703925795772184587177409936498087254406616175946169289444508481860637355419693798382917460025617427874613455109512107272512304304104906593970936717384774606309078932065707520524244463905987599522832675327192003768240357565000098017077857518036420185085830749303817570797252661573593545972381969693213032145555785557171042925649411870684921818964119502006215880946497988812317390769697729","city":"64207515840078382943292262079609797529323428107407346258064035891565810068650783432280668631249979192598709282156087609163524304223309281731783844316185443619999776343259676649413856722232942986890376525470425228820394938502810712398674377441429429362789673119682032341339305175196708447490579654671200180592586121923696945190584746522353219980296379868047103438227465262411362758994523172646208640637873323080134672178633544293891576196909296569112742568688378727293473745450879827390318066879697661520151842832868367837404550720649353378520677531608805204998138507919750895017109246232853373016446112161427489521690","state":"12354275070366449591120391350507606720463235964209956584348892277576324745652881861602328922589674658602081642432856770058340373914947775153412510137860231129202780585752212606794574979876301154338738739003628519875036022769510858823901508550787221706222883140381824949084385679371125257748565240095902330799573579780737008139070668421367673319450781752205574254609649733855628292484886695380243432230385774357526270808424191428023784345390876286355231741257382392598080196879370321113465297398771385692268496497480618321400859631833232715620813359844312828294502486541980254323562579553445975851571819600189058944236","zip":"14462915285397475860757782964444122443816041700827207959933950039563781356808918367132295062757178397211465455065352165572252374148732198882609965220846203277042762313991175375352301766730152925725094303307718826925337032138957434900474367827428990566127416665779672688221239074290999569667390585766000743755856967549159502138446123510388761407805995531295159537567746225991070297278580276152319534254142525488709695832781642697887032158416443173298486685662446941725110992848373760808931217328080456730152704327293055645617744944771589057362029410228526171635083307634947624710720246161152856186839294562680237077377"},"rctxt":"40934416858610928126480022346407881069779623213459431992094088258918772686391208546748347039334218655753433338912390482455557861021351170988527551242549973135321964819135860275788772974148345905430701929056029637770699643195956286200790537381658472553137748888634189657468302247510663430609503740481297860894806250017610186488634869257464571965470345334025087651540431700249456722992188484289733987288470572105268628421116911370278536073150849020523410033213766172238632610634826459496359422971526742757581273424717936090992723143955466464227905103748683745283311598347510870400300644944780876775609331857034276870604","z":"87113457327189040549606413755936465163120406060040239814533511350745548814353394919946100309012768259096835212274923141544702119288985415468638558329784496624902829809270877569964121168787842654319183231029182134475613789902119588446644771097499988068858402566949162187846414990768373483049399849145160971436341137095889226232973883817135896469880229825082571254775109565981482815352439949440079737635836871402515819907047203967287316549820897777823515151202769784217702532251548445019873389827924572815788083893974550151139631295628772895984876759799066041401531707900225142621964126714211486728093180609627772980013"}}}"#,
        r#"2018-04-20 17:44:53"#,
    ],
    [
        r#"credential_private_key::2hoqvcwupRTUNkXn6ArYzs:3:CL:2200"#,
        r#"{"p_key":{"p":"160538453337316368586199398621784141453015866126585572680637133899770651587525122343568501440475733121513391437542837068499711274394079394737210404506880030245203826282376227875617699974283471150357273065826557356550391468590144772791507342470623667601036521496237443657625425021277713032893593582726714690131","q":"138193191242699226526241917897931696455587044821330904036386205061487193396623643751133557096472962912067669791905037625326979892319649376322931463409362975076046496472524595417586754978456388211873550122670184657622089802342908892529402704441954859967430180559967792009952276100478458378920253023207230537443"},"r_key":null}"#,
        r#"2018-04-20 17:44:53"#,
    ],
    [
        r#"credential_key_correctness_proof::2hoqvcwupRTUNkXn6ArYzs:3:CL:2200"#,
        r#"{"c":"10437046434447724155505596484473580601384814700515338401673278224431194077828","xz_cap":"22084314264637161944820490987660927987373399056575008779017867167252138440843668689412386147390458512078490541915569595570397019084805008979913962409821926812557891221993003863107415413778913370364772713619653725554770887802259724414168939551108788400593034511619183259379502138341181728673369248462488178472611280515580866602944116667248054771548720263629884407167939160570659379793468870933163914907281066313414821665452455442279998265055101151745441528995851448805986511959238732300333483894601148600448735983164365233442075320471417358812478077740026033213206531843104126570336561713466958732389645625747439437655397191915915307519403095375396648708479778768811932575403703547831837995933","xr_cap":{"address1":"116130756347546758865064292410910119613908005616874684870768245930744422424452608473488864426277910318275077328393777465966680908854907191434519279210426086728455594188097610546453200495322475265759403630582673420417140905256638851372628206951265134711719821160415379068855527896122160537958310505750908906026662603459460071016721615796276067296627294032058074821754867447244375501670748872590339924997326691822611674936394992625912878391713058434266694025688129851660366983202118163126546405730598670716246094068349710335657013342959765158418276593768702400257775165847783277703626288636267387637857566748692088500304428486460590840209157807349829763086747473577055728687068298417640436716616","address2":"214638503328996891442067100314786586721692224967237684130438162039240301205373970973524008450489085796656489123913255388938165905796340262028356929860992740480705326780321710385445334165341318479716073451414832901848099104392632322692484356014301245474718072201897862138488706664247390327337553732491721866890765772017680129373023959786554387289187428206853472031631588268189611785253701508719336108120768238021057793554177324401036388889569372500875963926684492525312171133840263462123370635466608424492781297170737445337293043892876693902991038916631586558624323993450928647619409426133313078547359364726044274172492968306920533024263429040766389968240830901292025950743923781160950501608459","city":"31826264030301679235002078942731341359101661557729688206568487303175136716483288387908742150994827761798635909652892447638715853514489532911862473765233457243812819426997068918737314446871759089450250778468141922105972317677089282538653161669066666987673900433393529176757365262836109688350414115698115708989714841347434209839491185111624044820383110013233315786249609870397637283376169555609646248779124706354138527048511457787159658598997513414710221791462980207138021073520016098639959256243514235171625109621126124604609607661012296775943485978636983510213597355127782156298528206958033305119255937575885360707887227526958345725429448035824024423606362625388502630662749523325565308929267","state":"207501426672673751384057579801074599847358913350702086994087893320506309342740309490592157168607818911465158043385035209111019257087162595589584785071897363452303756595642885465223334246834253264646246169761422047920538957523699213928290352548982941611657954826171699678026399702900453416643052327753470857362931872596958289990450122105158542499541673433712093150595376101794986210941102169327056918330374870133972952719907243507652329954169142993553324378198048054392661585201344779675971676515969829104855067857883057962745699161996084055820492234356136124096474384618984735596068860585892074603085641120430185215711369815024023791393977627734216307595579640016472800072832379466887960814272","zip":"207693033586554957480685787075602527576974753137260689388843122207683061325392554651058425412728050982006153068509180704088416218488851362628741024572051219850851926228736062042423645481812863095365666870816104068725683451621129988900696762980928412777061088760303308895474417790903153672356274535804666189822870270434373004487526241946157590145141680505337455414577326713541124877539321371869020773056731182080132685889580680017610705343462506972666691424385268918360286811678663037746611172172276492778726922887304442626130353175695021907907916220728005912768597606549298993600998673417618959395053168823643832152054298474603245215708759735379607230902437999278609459692938893127427173802671"}}"#,
        r#"2018-04-20 17:44:53"#,
    ],
    [
        r#"full_schema_id::2hoqvcwupRTUNkXn6ArYzs:3:CL:2200"#,
        r#"2hoqvcwupRTUNkXn6ArYzs:2:Home Address - Test:0.0.1"#,
        r#"2018-04-20 17:44:53"#,
    ],
    //DID DunkM3x1y7S4ECgSL4Wkru
    [
        "my_did::DunkM3x1y7S4ECgSL4Wkru",
        r#"{"did":"DunkM3x1y7S4ECgSL4Wkru","verkey":"837gvxJ2pUuhCspWti7qiRAo2JKCKaHg4X1k9SuKemWY"}"#,
        "2018-01-19 21:26:11"
    ],
    [
        "key::837gvxJ2pUuhCspWti7qiRAo2JKCKaHg4X1k9SuKemWY",
        r#"{"verkey":"837gvxJ2pUuhCspWti7qiRAo2JKCKaHg4X1k9SuKemWY","signkey":"xt19s1sp2UZCGhy9rNyb1FtxdKiDGZZPP7Uk7LfAi6P2ZgcpNMagSN7K1TDc73gkBzdpqvUAmpPnnxRLqXeBZbv"}"#,
        "2018-01-19 21:26:11"
    ],
    //DID 2hoqvcwupRTUNkXn6ArYzs
    [
        "my_did::2hoqvcwupRTUNkXn6ArYzs",
        r#"{"did":"2hoqvcwupRTUNkXn6ArYzs","verkey":"vrWGArMA3toVoZrYGSAMjR2i9KjBS66bZWyWuYJJYPf"}"#,
        "2018-02-28 04:09:37"
    ],
    [
        "key::vrWGArMA3toVoZrYGSAMjR2i9KjBS66bZWyWuYJJYPf",
        r#"{"verkey":"vrWGArMA3toVoZrYGSAMjR2i9KjBS66bZWyWuYJJYPf","signkey":"xt19s1sp2UZCGhy9rNyb1FtxdKiDGZZPPWbEpqU41NEy3MmoeUuhq6T8F4JuRPgtj3hoT6BBjgnEF4bbhsR84NH"}"#,
        "2018-02-28 04:09:37"
    ],
    //DID AQ2EZRY9JQ4ssjmZPL5MiU"
    [
        "my_did::AQ2EZRY9JQ4ssjmZPL5MiU",
        r#"{"did":"AQ2EZRY9JQ4ssjmZPL5MiU","verkey":"684CRDu3k4TGBzNU99JTqM8cVS4ZtRwC7eZHEvZjzMRX"}"#,
        "2018-02-28 04:09:37"
    ],
    [
        "key::684CRDu3k4TGBzNU99JTqM8cVS4ZtRwC7eZHEvZjzMRX",
        r#"{"verkey":"684CRDu3k4TGBzNU99JTqM8cVS4ZtRwC7eZHEvZjzMRX","signkey":"3GNKQyCswPamSCTPHj9BzJFY3DcXbswXLcteWUNtfgnD4f1rqbLiGTtqpehdg4nxpNz3o3S5iawopUCYbgURTGZT"}"#,
        "2018-02-28 04:09:37"
    ],
    //DID EmapZ8H9S2qPp3JKyfr5z1
    [
        "my_did::EmapZ8H9S2qPp3JKyfr5z1",
        r#"{"did":"EmapZ8H9S2qPp3JKyfr5z1","verkey":"8WFnbdyQkZ7pZDX9FRCLbtH4bjy3AacWKPYkpxHCxaVq"}"#,
        "2018-01-19 20:27:15"
    ],
    [
        "key::8WFnbdyQkZ7pZDX9FRCLbtH4bjy3AacWKPYkpxHCxaVq",
        r#"{"verkey":"8WFnbdyQkZ7pZDX9FRCLbtH4bjy3AacWKPYkpxHCxaVq","signkey":"xt19s1sp2UZCGhy9rNyb1FtxdKiDGZZPP7Uk7LfAi6PvimpyRHkzenYNbW6eLf5DKWU9mWHFQMWVpMQc7Bq3EL3"}"#,
        "2018-01-19 20:27:15"
    ],
    [
        "my_did::QgUb4aHJ2cigGZCrEe7DHk",
        r#"{"did":"QgUb4aHJ2cigGZCrEe7DHk","verkey":"DubGpQctfhNRw4cmzqaHjne6qokwpxuWrhiTJgJEGs7q"}"#,
        "2018-03-12 15:31:34"
    ],
    [
        "key::DubGpQctfhNRw4cmzqaHjne6qokwpxuWrhiTJgJEGs7q",
        r#"{"verkey":"DubGpQctfhNRw4cmzqaHjne6qokwpxuWrhiTJgJEGs7q","signkey":"3vSwMtqns4Y8oy6oUZ2Uxmf8aUz4tayb8gSSEUnnbexNZrimVH5HdERSFi2aPdwQgC9ynBbYvBPCkUG2Xq2NapJF"}"#,
        "2018-03-12 15:31:34"
    ],
    [
        "my_did::GXTZy9GzdtD2c1J88Jrn8C",
        r#"{"did":"GXTZy9GzdtD2c1J88Jrn8C","verkey":"9TnFnc8LQ8LhRQjLVjdBR7Sk63yjEkJ3ifvue4bftJJc"}"#,
        "2018-03-12 15:31:34"
    ],
    [
        "key::9TnFnc8LQ8LhRQjLVjdBR7Sk63yjEkJ3ifvue4bftJJc",
        r#"{"verkey":"9TnFnc8LQ8LhRQjLVjdBR7Sk63yjEkJ3ifvue4bftJJc","signkey":"5QEbR1JPRorcTazTgdH71nQqzVDhHs8cqSzT2at6LeS7soCWBqhu1kFdiKyKaks1qyg5GAsQp3GFScNAAJUCiomJ"}"#,
        "2018-03-12 15:31:34"
    ],
];

pub fn setup_dev_env(wallet_name: &str) {
    settings::set_defaults();
    pool::open_sandbox_pool();
    set_institution_dev_config(wallet_name);

    setup_wallet(wallet_name);
    wallet::open_wallet(wallet_name, None).unwrap();
}

pub fn be_consumer() {
    set_consumer_dev_config()
}
pub fn be_institution() {
    /* use the existing wallet */
    set_institution_dev_config(&settings::get_config_value(settings::CONFIG_WALLET_NAME).unwrap());
}

pub fn cleanup_dev_env(wallet_name: &str) {
    settings::set_defaults();
    wallet::close_wallet().unwrap();
    wallet::delete_wallet(wallet_name).unwrap();
    pool::close().unwrap();
    pool::delete(::utils::constants::POOL).unwrap();
}

fn set_institution_dev_config(wallet_name: &str) {
    let institution_logo_url = format!("https://robohash.org/123");
    settings::set_config_value(settings::CONFIG_INSTITUTION_NAME,"Evernym");
    settings::set_config_value(settings::CONFIG_WALLET_NAME, wallet_name);
    settings::set_config_value(settings::CONFIG_AGENCY_ENDPOINT, AGENCY_ENDPOINT);
    settings::set_config_value(settings::CONFIG_AGENCY_DID, AGENCY_DID);
    settings::set_config_value(settings::CONFIG_AGENCY_VERKEY, AGENCY_VERKEY);
    settings::set_config_value(settings::CONFIG_SDK_TO_REMOTE_DID, SDK_TO_REMOTE_DID);
    settings::set_config_value(settings::CONFIG_SDK_TO_REMOTE_VERKEY, SDK_TO_REMOTE_VERKEY);
    settings::set_config_value(settings::CONFIG_INSTITUTION_DID, INSTITUTION_DID);
    settings::set_config_value(settings::CONFIG_INSTITUTION_VERKEY, INSTITUTION_VERKEY);
    settings::set_config_value(settings::CONFIG_REMOTE_TO_SDK_DID, REMOTE_TO_SDK_DID);
    settings::set_config_value(settings::CONFIG_REMOTE_TO_SDK_VERKEY, REMOTE_TO_SDK_VERKEY);
    settings::set_config_value(settings::CONFIG_INSTITUTION_LOGO_URL, &institution_logo_url);
    settings::set_config_value(settings::CONFIG_GENESIS_PATH, constants::GENESIS_PATH);
}

fn set_consumer_dev_config() {
    /* NOTE: WALLET_NAME stays the same */
    let institution_logo_url = format!("https://robohash.org/456");
    settings::set_config_value(settings::CONFIG_INSTITUTION_NAME,"Evernym");
    settings::set_config_value(settings::CONFIG_AGENCY_ENDPOINT, C_AGENCY_ENDPOINT);
    settings::set_config_value(settings::CONFIG_AGENCY_DID, C_AGENCY_DID);
    settings::set_config_value(settings::CONFIG_AGENCY_VERKEY, C_AGENCY_VERKEY);
    settings::set_config_value(settings::CONFIG_SDK_TO_REMOTE_DID, C_SDK_TO_REMOTE_DID);
    settings::set_config_value(settings::CONFIG_SDK_TO_REMOTE_VERKEY, C_SDK_TO_REMOTE_VERKEY);
    settings::set_config_value(settings::CONFIG_INSTITUTION_DID, C_INSTITUTION_DID);
    settings::set_config_value(settings::CONFIG_INSTITUTION_VERKEY, C_INSTITUTION_VERKEY);
    settings::set_config_value(settings::CONFIG_REMOTE_TO_SDK_DID, C_REMOTE_TO_SDK_DID);
    settings::set_config_value(settings::CONFIG_REMOTE_TO_SDK_VERKEY, C_REMOTE_TO_SDK_VERKEY);
    settings::set_config_value(settings::CONFIG_INSTITUTION_LOGO_URL, &institution_logo_url);
    settings::set_config_value(settings::CONFIG_GENESIS_PATH, constants::GENESIS_PATH);
}

fn setup_new_wallet_with_new_credential(wallet_name: &str) {
    settings::set_defaults();

    pool::open_sandbox_pool();

    wallet::init_wallet(wallet_name).unwrap();
    let wallet_handle = wallet::get_wallet_handle();

    let (issuer_did, _) = SignusUtils::create_and_store_my_did(wallet_handle, Some(constants::DEMO_ISSUER_PW_SEED)).unwrap();
    SignusUtils::create_and_store_my_did(wallet_handle, Some(constants::DEMO_AGENT_PW_SEED)).unwrap();

    for x in 0..12 {
        let seed = format!("000000000000000000000000Issuer{:02}", x);
        println!("generating did/vk from seed: {}", seed);
        SignusUtils::create_and_store_my_did(wallet_handle, Some(&seed)).unwrap();
    }

    let data = r#"["address1","address2","city","state","zip"]"#.to_string();
    let version = "0.1".to_string();
    let name = "Home Address".to_string();
    let schema_handle = create_new_schema("1", issuer_did.to_string(), name, version, data).unwrap();

    //Todo: change to get_schema_id and update create_cred call
    let schema_seq_no = get_sequence_num(schema_handle).unwrap();

//    create_new_credentialdef("anything".to_string(), "anything".to_string(), schema_seq_no, issuer_did, false).unwrap();
}

pub fn setup_wallet(wallet_name: &str) {
    use std::path::Path;
    use self::rusqlite::Connection;
    use std::env::home_dir;

    let home = home_dir().unwrap();
    let wallet_dir = format!(".indy_client/wallet/{}/sqlite.db", wallet_name);
    let wallet_dir = Path::new(&wallet_dir);
    let wallet_db = home.join(wallet_dir);

    wallet::init_wallet(wallet_name).unwrap();
    let connection = Connection::open(wallet_db.as_path()).unwrap();

    for entry in DEV_ENTRIES {
        connection.execute("INSERT OR REPLACE INTO wallet VALUES (?,?,?)", &[&entry[0].to_string(), &entry[1].to_string(), &entry[2].to_string()]).unwrap();
    }
    connection.close().unwrap();
    wallet::close_wallet().unwrap();
}

#[cfg(test)]
mod tests {
    use super::*;

    #[ignore]
    #[test]
    fn test_dev_env_setup() {
        // Use this test to setup a complete wallet for external use
        setup_dev_env("pyvcx");
        ::utils::libindy::anoncreds::libindy_prover_create_master_secret(::settings::DEFAULT_LINK_SECRET_ALIAS).unwrap();
    }
}
